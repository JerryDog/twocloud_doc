


获取虚拟机列表
====================

.. toctree::
   :maxdepth: 2
   :numbered:



概要
--------------------

返回当前区域项目所有虚拟机列表


API规范
--------------------------

获取虚拟机API入口与API列表如下：


    * API入口: http://tcapi.twocloud.cn
    * API列表:

+------------------+-------------------------------+------------+--------------------------------+
|  资源            |  操作                         |  HTTP方法  |  URI路径                       |
+==================+===============================+============+================================+
|  servers         |  获取所有虚拟机列表           |  GET       |  /twocloud/servers             |
+------------------+-------------------------------+------------+--------------------------------+

先认证并获取新令牌(已可用), 使用该令牌执行获取动作
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

+------------+---------------------+-----------------+
|  HTTP方法  |  URI路径            |  描述           |
+============+=====================+=================+
|  GET       |  /twocloud/servers  |  获取虚拟机列表 |
+------------+---------------------+-----------------+

请求参数

+-----------------------+----------+---------------+
|  字段名               |  类型    |  描述         |
+=======================+==========+===============+
|  token（必选）        |  string  |  token        |
+-----------------------+----------+---------------+
|  password             | string   |  任意字符串   |
+-----------------------+----------+---------------+
|  tenant_id（必选）    |  string  |  租户id       |
+-----------------------+----------+---------------+
|  region（必选）       |  string  |  所属区域     |
+-----------------------+----------+---------------+
|  party（必选）        |  string  |  接入方       |
+-----------------------+----------+---------------+
|  f（可选）            |  int     |  分页起始点   |
+-----------------------+----------+---------------+
|  t（可选）            |  int     |  分页结束点   |
+-----------------------+----------+---------------+

请求样例

::


    curl  -i \
          -u '{token}:password' \
          -X GET 'http://tcapi.twocloud.cn/twocloud/servers?party=qcloud&tenant_id=123&region=gz&f=1&t=10'



返回参数

+-------------------+-------------+-------------------------------------------------------------------------+
|  字段名           |  类型       |  描述                                                                   |
+===================+=============+=========================================================================+
|  code             |  int        |  返回码                                                                 |
+-------------------+-------------+-------------------------------------------------------------------------+
|  vm_servers       |  dict       |  包含了符合条件的虚拟机列表，每个虚拟机详细信息                         |
+-------------------+-------------+-------------------------------------------------------------------------+
|  instance_name    |  string     | 实例名                                                                  |
+-------------------+-------------+-------------------------------------------------------------------------+
|  instance_id      |  string     |  实例ID                                                                 |
+-------------------+-------------+-------------------------------------------------------------------------+
|  cpu_num          |  int        |  cpu 核数                                                               |
+-------------------+-------------+-------------------------------------------------------------------------+
|  mem_size         |  int        |  虚拟机机内存                                                           |
+-------------------+-------------+-------------------------------------------------------------------------+
|  disk_size        |  int        |  虚拟机机磁盘                                                           |
+-------------------+-------------+-------------------------------------------------------------------------+
|  lan_ip_set       |  string     |  内网IP ，多个逗号分隔                                                  |
+-------------------+-------------+-------------------------------------------------------------------------+
|  wan_ip_set       |  list       |  外网IP，多个逗号分隔                                                   |
+-------------------+-------------+-------------------------------------------------------------------------+
|  status           |  string     |  虚拟机机状态                                                           |
+-------------------+-------------+-------------------------------------------------------------------------+
|  create_at        |  string     |  创建时间                                                               |
+-------------------+-------------+-------------------------------------------------------------------------+
|  update_at        |  string     |  更新时间                                                               |
+-------------------+-------------+-------------------------------------------------------------------------+


返回样例

::


        HTTP/1.0 200 OK
        Content-Type: application/json
        Content-Length: 537
        Server: Werkzeug/0.10.4 Python/2.7.5
        Date: Thu, 28 Jan 2016 05:53:28 GMT

        {
          "code": 200,
          "msg": "",
          "vm_servers": [
            {
              "instance_name": "hehe",
              "instance_id": "u23j34j234j23h4",
              "cpu_num": 8,
              "mem_size": 16,
              "disk_size": 20,
              "lan_ip_set": "192.168.0.2,192.168.0.3",
              "wan_ip_set": "122.22.3.45,122.22.3.46",
              "status": "ACTIVE",
              "create_at": "2014-07-29 15:08:39",
              "update_at": "2014-08-05 17:37:56"
            },
            {
              "instance_name": "haha",
              "instance_id": "234sdf342323",
              "cpu_num": 4,
              "mem_size": 8,
              "disk_size": 20,
              "lan_ip_set": "192.168.0.2,192.168.0.3",
              "wan_ip_set": "122.22.3.45,122.22.3.46",
              "status": "ERROR",
              "create_at": "2014-07-29 15:08:39",
              "update_at": "2014-08-05 17:37:56"
            }
          ]
        }

